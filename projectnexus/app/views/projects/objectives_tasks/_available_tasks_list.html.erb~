<div id="available_tasks_list">
  Other/unassigned tasks: <button class="add_task"> + </button>


    <%= form_for(Task.new, :remote=>true) do |f| %>
      <div class="field">
	<%= f.label :name %><br />
	<%= f.text_field :name %>
      </div>
      <div class="field">
	<%= f.label :description %><br />
	<%= f.text_field :description %>
      </div>
      <div class="field">
	<%= f.label :duedate %><br />
	<%= f.datetime_select :duedate %>
      </div>
      <div class="field">
	<%= f.label :objective %><br />
	<%= collection_select(:task, :objective_id, @project.objectives, :id, :name, {:prompt => true}) %>
      </div>
      <div class="actions">
	<%= f.submit %>
      </div>
    <% end %>


  <ul>
    <% @project.objectives.each do |objective| %>
    <li class="objective">
      <%= objective.name %>
      <ul>
	
	<% objective.tasks.each do |task| %>
	<% if task.user_id %>

	<% else %>
          <li class="task">
	    <%= task.name %>
	    <% @task = task %>
	    <%= form_for(@task, :method => :put, :remote=>true) do |f| %>
	    <%= f.hidden_field :user_id, :value => current_user.id %>
	    <%= f.submit "Claim" %>
	    <% end %>
	  </li>
	  <% end %>
	<% end %>
	
	<li>
<!--
	      <%= form_for(Task.new, :remote=>true) do |f| %>
	      <div class="field">
		<%= f.label :name %><br />
		<%= f.text_field :name %>
	      </div>
	      <div class="field">
		<%= f.label :description %><br />
		<%= f.text_field :description %>
	      </div>
	      <div class="field">
		<%= f.label :duedate %><br />
		<%= f.datetime_select :duedate %>
	      </div>
	      <div class="field">
		<%= f.hidden_field :objective_id, :value => objective.id %><br />
	      </div>
	      <div class="actions">
		<%= f.submit %>
	      </div>
	      <% end %>
-->	</li>
	
      </ul>
    </li>
    <% end %>
  </ul>
</div>
